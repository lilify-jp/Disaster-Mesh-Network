# 災害用メッシュネットワーク (Disaster Mesh Network)

## 概要
インターネット遮断時専用の災害通信システム。Windows PCのWi-FiやBluetooth機能を使い、サーバーを経由せずにP2P方式でメッセージやファイルを転送します。

## 特徴
- **完全オフライン動作**: インターネット回線不要
- **メッシュネットワーク**: 各PCが中継基地局として機能
- **自動ルーティング**: 最適な経路を自動選択
- **ファイル転送対応**: テキストメッセージだけでなくファイルも送信可能
- **暗号化通信**: すべての通信を暗号化

## 使用技術
- Python 3.8+
- Socket Programming (TCP/UDP)
- P2P通信プロトコル
- Tkinter (GUI)
- AES暗号化

## 動作原理
1. **ノード検出**: UDPブロードキャストで周辺のノードを自動検出
2. **メッシュ構築**: 検出されたノード間でメッシュネットワークを構築
3. **バケツリレー**: 中間ノードを経由してメッセージを転送
4. **経路最適化**: 最短ホップ数で目的地へ到達

## インストール

```bash
# 依存パッケージのインストール
pip install -r requirements.txt
```

## 使い方

```bash
# 通常モードで起動
python main.py

# セキュアモードで起動（推奨）
python main.py --secure

# 中継専用モードで起動（省電力）
python main.py --relay-only
```

### 基本操作
1. **ノード起動**: プログラムを起動すると自動的に周辺ノードを検出
2. **メッセージ送信**: GUIから宛先を選択してメッセージを入力
3. **ファイル送信**: ファイル選択ボタンからファイルを転送
4. **中継機能**: 自動的に他のノード間のメッセージを中継

## ユースケース

### 1. 災害時の避難所間通信
携帯基地局が破壊されても、避難所に設置されたPCが中継して通信可能

### 2. 安否確認
近隣住民との安否確認メッセージの交換

### 3. 物資情報の共有
「○○避難所に水があります」などの情報を共有

### 4. 緊急情報の伝達
火災や建物倒壊などの危険情報を迅速に伝達

## システム構成

```
disaster-mesh-network/
├── main.py              # メインアプリケーション
├── mesh_node.py         # メッシュノードのコア実装
├── message_router.py    # メッセージルーティング
├── file_transfer.py     # ファイル転送
├── crypto_utils.py      # 暗号化ユーティリティ
├── gui.py              # GUIインターフェース
├── requirements.txt     # 依存パッケージ
└── README.md           # このファイル
```

## 技術詳細

### メッシュネットワークプロトコル
- **Discovery**: UDPブロードキャスト (ポート 5000)
- **Data Transfer**: TCP (ポート 5001)
- **Heartbeat**: 30秒間隔でノードの生存確認
- **TTL**: メッセージの最大ホップ数 20

### ルーティングアルゴリズム
- Dijkstra法による最短経路探索
- ノード間のレイテンシを重みとして使用
- 動的な経路再計算

## セキュリティ

### 標準モード
- AES-256による暗号化
- ノード間の認証（共有キー方式）
- メッセージの改ざん検出

### セキュアモード（`--secure`）
- **公開鍵暗号方式**: 各ノードが独自の鍵ペアを保持
- **デジタル署名**: ECDSA による署名で送信元を保証
- **なりすまし防止**: 署名検証により偽ノードを自動排除
- **信頼スコアシステム**: 不審なノードを自動検出・ブロック
- **AES-256暗号化**: 通信内容を完全保護

⚠️ **重要**: 災害時の重要通信には必ずセキュアモードを使用してください

## 制限事項
- Wi-Fi範囲: 屋外で約50-100メートル
- 最大ホップ数: 20ホップ
- 同時接続ノード数: 最大50ノード

## ライセンス
MIT License

## 貢献
プルリクエスト歓迎します

## 免責事項
このソフトウェアは災害時の緊急通信を想定していますが、公式な緊急通信手段の代替ではありません。
